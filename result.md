# 神经网络多频因子结果

本文主要研究了三种模型来预测股票的T+10收益率，三种模型如下：

* 基于 GRU 的15分钟频数据模型（分钟模型）

* 日频+15分钟频数据混合模型（混合模型）

* 基于参数冻结+残差预测的增量学习模型（冻结模型）

超参数如下，基本和华泰证券研报保持一致：

```python
input_size1 = 6
input_size2 = 6
hidden_size = 30
output_size = 1
learning_rate = 0.0001
num_epochs = 50
batch_size = 1024
```

其中`input_size1`和`input_size2`分别表示15分钟频数据的特征长度和日频数据的特征长度。接下来分别展示三种模型的结果。

## 1. 基于GRU的15分钟频数据模型

模型从2017年开始每半年进行一次滚动训练，所有滚动训练的结果如下：

| Date       | Best Train Loss | Best Test Loss |
| ---------- | --------------- | -------------- |
| 2016-12-32 | -0.12359        | -0.07586       |
| 2017-06-31 | -0.11164        | -0.06527       |
| 2017-12-32 | -0.10669        | -0.09989       |
| 2018-06-31 | -0.10676        | -0.09524       |
| 2018-12-32 | -0.12151        | -0.13839       |
| 2019-06-31 | -0.12731        | -0.13036       |
| 2019-12-32 | -0.12874        | -0.11622       |
| 2020-06-31 | -0.12841        | -0.08776       |
| 2020-12-32 | -0.12885        | -0.08138       |
| 2021-06-31 | -0.12310        | -0.07100       |
| 2021-12-32 | -0.12314        | -0.07118       |
| 2022-06-31 | -0.12364        | -0.07760       |
| 2022-12-32 | -0.11346        | -0.08541       |
| 2023-06-31 | -0.11491        | -0.08761       |

每次滚动训练完成之后都会对接下来的半年进行回测，回测的结果如下图：

<img title="" src="file:///C:/Users/zhouling_intern3/Documents/gru_backup/pic/result_min_2017_000905.SH_bench_self_def_pool_pool_quantile_excess_return_2017-01-04_to_2023-06-30.png" alt="" data-align="inline">

在滚动回测每半年的数据结果如下：

| Date       | IC Mean | IC Std  | Rank IC | IC_IR   | postive_ic |
| ---------- | ------- | ------- | ------- | ------- | ---------- |
| 2017-06-31 | 0.05377 | 0.10854 | 0.05600 | 0.49541 | 0.64706    |
| 2017-12-32 | 0.05350 | 0.08520 | 0.05656 | 0.62789 | 0.73600    |
| 2018-06-31 | 0.10498 | 0.05803 | 0.09994 | 1.80907 | 0.97479    |
| 2018-12-32 | 0.11355 | 0.06688 | 0.10239 | 1.69781 | 0.97581    |
| 2019-06-31 | 0.13506 | 0.08907 | 0.16487 | 1.51634 | 0.90678    |
| 2019-12-32 | 0.08001 | 0.07079 | 0.09927 | 1.13019 | 0.88095    |
| 2020-06-31 | 0.07231 | 0.09182 | 0.09481 | 0.78748 | 0.81197    |
| 2020-12-32 | 0.06848 | 0.08505 | 0.09781 | 0.80515 | 0.78571    |
| 2021-06-31 | 0.06235 | 0.07307 | 0.07560 | 0.85338 | 0.80508    |
| 2021-12-32 | 0.05331 | 0.05886 | 0.08700 | 0.90567 | 0.81600    |
| 2022-06-31 | 0.09769 | 0.08204 | 0.10928 | 1.19078 | 0.86325    |
| 2022-12-32 | 0.09099 | 0.07841 | 0.10628 | 1.16039 | 0.86400    |
| 2023-06-31 | 0.06411 | 0.08668 | 0.08104 | 0.73960 | 0.73729    |

## 2. 日频+15分钟频数据混合模型（混合模型）

模型从2017年开始每半年进行一次滚动训练，所有滚动训练的结果如下：

| Date       | Best Train Loss | Best Test Loss |
| ---------- | --------------- | -------------- |
| 2016-12-31 | -0.12247        | -0.10777       |
| 2017-06-30 | -0.11651        | -0.07253       |
| 2017-12-31 | -0.10917        | -0.09106       |
| 2018-06-30 | -0.12694        | -0.11474       |
| 2018-12-31 | -0.13855        | -0.13729       |
| 2019-06-30 | -0.13335        | -0.12233       |
| 2019-12-31 | -0.14556        | -0.10336       |
| 2020-06-30 | -0.14305        | -0.08761       |
| 2020-12-31 | -0.13189        | -0.08196       |
| 2021-06-30 | -0.13375        | -0.08437       |
| 2021-12-31 | -0.12331        | -0.07968       |
| 2022-06-30 | -0.12416        | -0.07966       |
| 2022-12-31 | -0.12033        | -0.08728       |
| 2023-06-30 | -0.11648        | -0.08508       |

每次滚动训练完成之后都会对接下来的半年进行回测，回测的结果如下图：

![](C:\Users\zhouling_intern3\Documents\gru_backup\pic\result_day_2017_000905.SH_bench_self_def_pool_pool_quantile_excess_return_2017-01-04_to_2023-06-30.png)

在滚动回测每半年的数据结果如下：

| Date       | IC Mean | IC Std  | Rank IC | IC_IR   | postive_ic |
| ---------- | ------- | ------- | ------- | ------- |:---------- |
| 2017-06-30 | 0.05973 | 0.07549 | 0.06072 | 0.79124 | 0.76471    |
| 2017-12-31 | 0.06499 | 0.10351 | 0.06025 | 0.62787 | 0.78400    |
| 2018-06-30 | 0.09799 | 0.05181 | 0.09238 | 1.89148 | 0.98319    |
| 2018-12-31 | 0.11164 | 0.07031 | 0.11279 | 1.58776 | 0.96774    |
| 2019-06-30 | 0.13420 | 0.09789 | 0.15526 | 1.37090 | 0.92373    |
| 2019-12-31 | 0.07208 | 0.07547 | 0.09563 | 0.95502 | 0.78571    |
| 2020-06-30 | 0.08155 | 0.08972 | 0.09583 | 0.90891 | 0.81197    |
| 2020-12-31 | 0.08041 | 0.09540 | 0.11009 | 0.84285 | 0.83333    |
| 2021-06-30 | 0.06831 | 0.07820 | 0.08061 | 0.87352 | 0.78814    |
| 2021-12-31 | 0.05793 | 0.06425 | 0.08950 | 0.90170 | 0.76000    |
| 2022-06-30 | 0.10721 | 0.09695 | 0.12396 | 1.10582 | 0.87179    |
| 2022-12-31 | 0.08940 | 0.07903 | 0.10061 | 1.13122 | 0.83200    |
| 2023-06-30 | 0.06890 | 0.08998 | 0.08076 | 0.76571 | 0.72034    |



## 3. 基于参数冻结+残差预测的增量学习模型（冻结模型）

模型从2017年开始每半年进行一次滚动训练，所有滚动训练的结果如下：

| Date       | day model Train Loss | day model Valid Loss | hybrid model Train Loss | hybrid model Valid Loss |
| ---------- | -------------------- | -------------------- | ----------------------- | ----------------------- |
| 2016-12-31 | -0.04434             | -0.00656             | -0.13552                | -0.08341                |
| 2017-06-30 | -0.03511             | -0.00781             | -0.12494                | -0.06059                |
| 2017-12-31 | -0.04208             | -0.00422             | -0.12899                | -0.08936                |
| 2018-06-30 | -0.03854             | 0.00068              | -0.15163                | -0.10929                |
| 2018-12-31 | -0.03622             | -0.00580             | -0.14670                | -0.13346                |
| 2019-06-30 | -0.04572             | -0.00354             | -0.15418                | -0.11105                |
| 2019-12-31 | -0.03778             | -0.00206             | -0.15024                | -0.10125                |
| 2020-06-30 | -0.03526             | -0.00432             | -0.15144                | -0.08225                |
| 2020-12-31 | -0.04582             | -0.00546             | -0.14895                | -0.07784                |
| 2021-06-30 | -0.04789             | -0.00268             | -0.14522                | -0.06813                |
| 2021-12-31 | -0.03952             | -0.00332             | -0.13442                | -0.07234                |
| 2022-06-30 | -0.03952             | -0.00525             | -0.13617                | -0.07218                |
| 2022-12-31 | -0.04147             | -0.00330             | -0.13185                | -0.07897                |
| 2023-06-30 | -0.04113             | -0.00191             | -0.13041                | -0.07571                |

回测结果如下：
![](C:\Users\zhouling_intern3\Documents\gru_backup\pic\result_double_2017_000905.SH_bench_self_def_pool_pool_quantile_excess_return_2017-01-04_to_2023-06-30.png)

在滚动回测每半年的数据结果如下：

| Date       | IC Mean | IC Std  | Rank IC | IC_IR   | postive_ic |
| ---------- | ------- | ------- | ------- | ------- | ---------- |
| 2017-06-30 | 0.05236 | 0.07126 | 0.05892 | 0.73474 | 0.75630    |
| 2017-12-31 | 0.06966 | 0.09434 | 0.07073 | 0.73831 | 0.77600    |
| 2018-06-30 | 0.09335 | 0.06179 | 0.08772 | 1.51067 | 0.94118    |
| 2018-12-31 | 0.11428 | 0.07491 | 0.10978 | 1.52551 | 0.95968    |
| 2019-06-30 | 0.13319 | 0.09266 | 0.14982 | 1.43733 | 0.94915    |
| 2019-12-31 | 0.07200 | 0.08225 | 0.09175 | 0.87538 | 0.79365    |
| 2020-06-30 | 0.07326 | 0.08300 | 0.09344 | 0.88262 | 0.80342    |
| 2020-12-31 | 0.06634 | 0.10067 | 0.09817 | 0.65902 | 0.73016    |
| 2021-06-30 | 0.06454 | 0.07370 | 0.07670 | 0.87566 | 0.80508    |
| 2021-12-31 | 0.05349 | 0.05879 | 0.07785 | 0.90984 | 0.81600    |
| 2022-06-30 | 0.09479 | 0.08399 | 0.10117 | 1.12863 | 0.86325    |
| 2022-12-31 | 0.08357 | 0.07262 | 0.09172 | 1.15077 | 0.84000    |
| 2023-06-30 | 0.06087 | 0.08549 | 0.07668 | 0.71207 | 0.72881    |